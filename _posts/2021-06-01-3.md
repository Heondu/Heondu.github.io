

---
layout: single

title:  "[유니티] 절차적 콘텐츠 생성을 위한 이진 트리 미로 알고리즘 학습"

comments: true

toc : true

---



## Binary Tree Algorithm이란?

2차원 배열 형태의 미로를 생성하는 알고리즘이다. 오른쪽 혹은 위쪽으로 랜덤하게 길을 만들어 미로를 생성한다. 가지치기 형태로 사용되는 일반적인 이진 트리 알고리즘과 미로 생성시 사용되는 이진 트리 알고리즘은 조금 차이가 있다.

 

## 생성 과정

1. 가장자리에 벽을 만든다.
2. 짝수 번호에 해당하는 칸을 벽으로 바꾼다. (따라서 짝수 크기의 미로는 생성할 수 없다.)
3. 2차원 배열 중 홀수 번호만 순회하면서 현재 배열에 입력된 정보가 길이라면 오른쪽 혹은 위쪽 방향으로 랜덤하게 선택해 길을 만든다.

​                                        

(1번 과정)             (2번 과정)             (3번 과정)             (최종 형태)      

 

## 소스 코드

```c#
private void CreateArray()
{
	mazeArray = new int[size.x, size.y]; //입력 받은 값으로 배열 초기화
  	for (int x = 0; x < size.x; x++) {
		for (int y = 0; y < size.y; y++) {
      		if (x == 1 && y == 0) mazeArray[x, y] = ROAD; //입구 생성
      		else if (x == size.x - 2 && y == size.y - 1) mazeArray[x, y] = ROAD; //출구 생성
      		else if (x == 0 || x == size.x - 1 || y == 0 || y == size.y - 1) mazeArray[x, y] = WALL; //가장자리 벽 생성
      		else if (x % 2 == 0 || y % 2 == 0) mazeArray[x, y] = WALL; //짝수 칸 벽 생성
      		else mazeArray[x, y] = ROAD; //나머지 공간 길 생성
    	}
	}

  	for (int x = 0; x < size.x; x++) {
    	for (int y = 0; y < size.y; y++) {
      	if (x % 2 == 0 || y % 2 == 0) continue; //짝수 번호는 건너뜀
      	if (x == size.x - 2 && y == size.y - 2) continue; //벽 뚫림 방지
      	if (x == size.x - 2) mazeArray[x, y + 1] = ROAD; //가장자리에 다다르면 다른 방향으로 길 생성
      	else if (y == size.y - 2) mazeArray[x + 1, y] = ROAD;
      	else if (Random.Range(0, 2) == 0) mazeArray[x + 1, y] = ROAD; //오른쪽 혹은 위쪽으로 핸덤하게 길 생성
      	else mazeArray[x, y + 1] = ROAD;
	}
}
```